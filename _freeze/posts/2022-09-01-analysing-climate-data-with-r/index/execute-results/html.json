{
  "hash": "b1a6b8704c1760428027c56b94aee9c9",
  "result": {
    "markdown": "---\ntitle: Analysing Climate data with R\nauthor: Ralph Trancoso\ndate: '2022-09-01'\nslug: []\ncategories:\n  - R\n  - climate\n  - raster\ntags: []\nTags: []\nCategories: []\nDisableComments: no\n---\n\n\nThis post contains the scripts provided by Ralph Trancoso in the Analysing Climate Data in R workshop. The recording is also available, just email mitchel.rudge\\@uq.edu.au for access.\n\n# 1 Installing and loading the data, and the `raster`, `ncdf4`, `rgdal`, and `ggplot2` packages, setting directory, loading gridded data\n\nTo follow this tutorial, you will need to [download some prepared climate data](https://cloudstor.aarnet.edu.au/plus/s/Z35pnzhUEpnK7Gt).\n\nSave this link to somewhere on you computer, in our example the c drive, the unzip the folder.\n\nIf you don't have the 'raster' and `ncdf4` packages installed, install them:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"raster\") # Installing the packages required for the workshop\ninstall.packages(\"ncdf4\")\ninstall.packages(\"rgdal\")\ninstall.packages(\"ggplot2\")\n```\n:::\n\n\nNow load the `raster` package, and set the directory to where you stored the Rclim folder.\n\nSet your home directory, for example, if you put the rclim folder on you C drive:\n\nwriteClipboard(gsub(\"\\\\\\\\\", \"/\", readClipboard())\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhome <- \"C:/Rclim\"\n```\n:::\n\n\nNow load the `raster` packages, and set your directory to where the climate data is.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(raster)\nsetwd(home) #workshop dataset\n\nsetwd(paste0(home, \"/worldclim\")) # Set work directory to worldclim data\n#getwd() # get work directory\n#dir() # list files in the work directory\n?stack # what does stack do?\naus_temp <- stack(\"tmean_australia_wc.nc\")  # Loading gridded #data as RasterStack\n```\n:::\n\n\n# 2 Querying the RasterStack data and quick plot using raster::plot and raster::spplot\n\nBelow are a whole bunch of checks that you can run on the raster data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nncol(aus_temp) #check the number of columns\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 554\n```\n:::\n\n```{.r .cell-code}\nnrow(aus_temp) #check the number of rows\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 551\n```\n:::\n\n```{.r .cell-code}\nncell(aus_temp) #check the number of cells\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 305254\n```\n:::\n\n```{.r .cell-code}\nnlayers(aus_temp) #check the number of layers\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 12\n```\n:::\n\n```{.r .cell-code}\ndim(aus_temp) #check the dimensions (rows, columns, layers)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 551 554  12\n```\n:::\n\n```{.r .cell-code}\nprojection(aus_temp) #check the projection\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"+proj=longlat +datum=WGS84 +no_defs\"\n```\n:::\n\n```{.r .cell-code}\nres(aus_temp) #check the resolution\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.08333333 0.08333333\n```\n:::\n\n```{.r .cell-code}\ninMemory(aus_temp) #check if the data is stored in memory\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nfromDisk(aus_temp) #check if the data was read from disk\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nnames(aus_temp) #check the names of the layers\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"X1\"  \"X2\"  \"X3\"  \"X4\"  \"X5\"  \"X6\"  \"X7\"  \"X8\"  \"X9\"  \"X10\" \"X11\" \"X12\"\n```\n:::\n:::\n\n\nNow plot the rasters using the `plot` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(aus_temp/10)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nOr use spplot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspplot(aus_temp/10) # lattice plot, returns a trellice \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nEach layer represents a month of the year, from 1-12. So lets rename the layers and plot again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonths <- c(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\")\n\nnames(aus_temp) <- months #set the layer names to months\n\nplot(aus_temp/10)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nOr, using `spplot` to create a lattice plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspplot(aus_temp/10) # lattice plot, returns a trellice \t\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n# 3 Calculating anomalies as gridded time-series and global average\n\nFirst, load the CMIP6 data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(paste0(home, \"/CMIP6\")) # Set work directory to CMIP6 data\nproj_temp <- stack(\"tas_Asea_ACCESS-ESM1-5_ssp370_r1i1p1f1_gr1.5_1950-2100.nc\")\nnames(proj_temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"X1\"   \"X2\"   \"X3\"   \"X4\"   \"X5\"   \"X6\"   \"X7\"   \"X8\"   \"X9\"   \"X10\" \n [11] \"X11\"  \"X12\"  \"X13\"  \"X14\"  \"X15\"  \"X16\"  \"X17\"  \"X18\"  \"X19\"  \"X20\" \n [21] \"X21\"  \"X22\"  \"X23\"  \"X24\"  \"X25\"  \"X26\"  \"X27\"  \"X28\"  \"X29\"  \"X30\" \n [31] \"X31\"  \"X32\"  \"X33\"  \"X34\"  \"X35\"  \"X36\"  \"X37\"  \"X38\"  \"X39\"  \"X40\" \n [41] \"X41\"  \"X42\"  \"X43\"  \"X44\"  \"X45\"  \"X46\"  \"X47\"  \"X48\"  \"X49\"  \"X50\" \n [51] \"X51\"  \"X52\"  \"X53\"  \"X54\"  \"X55\"  \"X56\"  \"X57\"  \"X58\"  \"X59\"  \"X60\" \n [61] \"X61\"  \"X62\"  \"X63\"  \"X64\"  \"X65\"  \"X66\"  \"X67\"  \"X68\"  \"X69\"  \"X70\" \n [71] \"X71\"  \"X72\"  \"X73\"  \"X74\"  \"X75\"  \"X76\"  \"X77\"  \"X78\"  \"X79\"  \"X80\" \n [81] \"X81\"  \"X82\"  \"X83\"  \"X84\"  \"X85\"  \"X86\"  \"X87\"  \"X88\"  \"X89\"  \"X90\" \n [91] \"X91\"  \"X92\"  \"X93\"  \"X94\"  \"X95\"  \"X96\"  \"X97\"  \"X98\"  \"X99\"  \"X100\"\n[101] \"X101\" \"X102\" \"X103\" \"X104\" \"X105\" \"X106\" \"X107\" \"X108\" \"X109\" \"X110\"\n[111] \"X111\" \"X112\" \"X113\" \"X114\" \"X115\" \"X116\" \"X117\" \"X118\" \"X119\" \"X120\"\n[121] \"X121\" \"X122\" \"X123\" \"X124\" \"X125\" \"X126\" \"X127\" \"X128\" \"X129\" \"X130\"\n[131] \"X131\" \"X132\" \"X133\" \"X134\" \"X135\" \"X136\" \"X137\" \"X138\" \"X139\" \"X140\"\n[141] \"X141\" \"X142\" \"X143\" \"X144\" \"X145\" \"X146\" \"X147\" \"X148\" \"X149\" \"X150\"\n[151] \"X151\"\n```\n:::\n:::\n\n\nWe can see that these names make no sense. So the names relate to years, we can re-name each layer:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyears <- seq(1950, 2100, by=1)\nnames(proj_temp ) <- years\nnames(proj_temp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"X1950\" \"X1951\" \"X1952\" \"X1953\" \"X1954\" \"X1955\" \"X1956\" \"X1957\" \"X1958\"\n [10] \"X1959\" \"X1960\" \"X1961\" \"X1962\" \"X1963\" \"X1964\" \"X1965\" \"X1966\" \"X1967\"\n [19] \"X1968\" \"X1969\" \"X1970\" \"X1971\" \"X1972\" \"X1973\" \"X1974\" \"X1975\" \"X1976\"\n [28] \"X1977\" \"X1978\" \"X1979\" \"X1980\" \"X1981\" \"X1982\" \"X1983\" \"X1984\" \"X1985\"\n [37] \"X1986\" \"X1987\" \"X1988\" \"X1989\" \"X1990\" \"X1991\" \"X1992\" \"X1993\" \"X1994\"\n [46] \"X1995\" \"X1996\" \"X1997\" \"X1998\" \"X1999\" \"X2000\" \"X2001\" \"X2002\" \"X2003\"\n [55] \"X2004\" \"X2005\" \"X2006\" \"X2007\" \"X2008\" \"X2009\" \"X2010\" \"X2011\" \"X2012\"\n [64] \"X2013\" \"X2014\" \"X2015\" \"X2016\" \"X2017\" \"X2018\" \"X2019\" \"X2020\" \"X2021\"\n [73] \"X2022\" \"X2023\" \"X2024\" \"X2025\" \"X2026\" \"X2027\" \"X2028\" \"X2029\" \"X2030\"\n [82] \"X2031\" \"X2032\" \"X2033\" \"X2034\" \"X2035\" \"X2036\" \"X2037\" \"X2038\" \"X2039\"\n [91] \"X2040\" \"X2041\" \"X2042\" \"X2043\" \"X2044\" \"X2045\" \"X2046\" \"X2047\" \"X2048\"\n[100] \"X2049\" \"X2050\" \"X2051\" \"X2052\" \"X2053\" \"X2054\" \"X2055\" \"X2056\" \"X2057\"\n[109] \"X2058\" \"X2059\" \"X2060\" \"X2061\" \"X2062\" \"X2063\" \"X2064\" \"X2065\" \"X2066\"\n[118] \"X2067\" \"X2068\" \"X2069\" \"X2070\" \"X2071\" \"X2072\" \"X2073\" \"X2074\" \"X2075\"\n[127] \"X2076\" \"X2077\" \"X2078\" \"X2079\" \"X2080\" \"X2081\" \"X2082\" \"X2083\" \"X2084\"\n[136] \"X2085\" \"X2086\" \"X2087\" \"X2088\" \"X2089\" \"X2090\" \"X2091\" \"X2092\" \"X2093\"\n[145] \"X2094\" \"X2095\" \"X2096\" \"X2097\" \"X2098\" \"X2099\" \"X2100\"\n```\n:::\n:::\n\n\nThe X is at the start of each of each year to ensure they are of type character.\n\nNow we can create a simple function to calculate the temperature anomaly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanomaly <- function(x) {\n    anom <-  x - mean(x[[32:61]]) # for reference period 1981-2100\n    names(anom) <- seq(1950, 2100, by=1)\t\n    return(anom)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nT_anom <- anomaly(proj_temp)\n```\n:::\n\n\nNow plot the temperature anomaly, from 1:16 (1950 - 1965)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspplot(T_anom[[1:16]])\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAnd from 2084 - 2100\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspplot(T_anom[[135:151]])\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nThen we can calculate the average temperature anomaly\n\n\n::: {.cell}\n\n```{.r .cell-code}\nT_anom_mean <- as.data.frame(cbind(years, cellStats(T_anom, mean)))\nnames(T_anom_mean) <- c(\"year\", \"T_anom_mean\")\n```\n:::\n\n\nFinally, we can take a look at the average temperature anomaloy for the entire dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(home) # Set work directory to main folder\ndir.create(\"output\")\nsetwd(paste0(home, \"/output\")) #set directory to output\njpeg(file=\"anomaly_ts.jpeg\", height = 600,  width = 1000, res=150)\nplot(T_anom_mean$year, T_anom_mean$T_anom_mean, type = \"p\", pch = 19, \n     col = \"red\", xlab=\"year\", ylab=\"Projected temperature anomaly\", \n     main=\"ACCESS-ESM1-5 SSP370 - ref period:1981-2010\")\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n:::\n\n\nHave a look in the output folder, you should see something like this\n\n![](images/anomaly_ts.jpeg)\n\n# 4 Handling regions as shapefiles\n\nHere, we load and plot a shapefile of the worlds country boundaries.\n\nHere, we load and plot a shapefile of the worlds country boundaries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rgdal)\n\nsetwd(paste0(home, \"/shp\"))\ncountries = readOGR(dsn=\".\", layer=\"TM_WORLD_BORDERS_SIMPL-0.3\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOGR data source with driver: ESRI Shapefile \nSource: \"C:\\Users\\uqnwiggi\\OneDrive - The University of Queensland\\UQGAC\\Rclim\\shp\", layer: \"TM_WORLD_BORDERS_SIMPL-0.3\"\nwith 246 features\nIt has 11 fields\nInteger64 fields read as strings:  POP2005 \n```\n:::\n\n```{.r .cell-code}\nplot(countries)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nOr use `spplot` to color by population:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspplot(countries, \"POP2005\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n# 5 Regionalizations of climate data - plotting time-series as line plot and bar chart\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nsetwd(paste0(home, \"/CMIP6\")) # Set work directory to CMIP6 data\nproj_temp <- stack(\"tas_Asea_ACCESS-ESM1-5_ssp370_r1i1p1f1_gr1.5_1950-2100.nc\")\nproj_temp <- proj_temp -273.15\nnames(proj_temp) <- c(seq(1950,2100, by=1))\n\n## From your countries vector we read in, select a country customise your study area for the workshop analysis:\nmy_country <- subset(countries, NAME == \"Australia\")\n\n\ndf<- as.data.frame(countries@data)\n#fix(df) # to have a look at the dataframe of the countries\n\nmydf <- structure(list(\nlongitude = c(153.0251, 145.7781, 149.1821, 146.8169, 139.4927, 144.2555), \nlatitude = c(-27.4698, -16.9186, -21.1425, -19.2590, -20.7256, -23.4422)), \n.Names = c(\"longitude\", \"latitude\"), class = \"data.frame\", row.names = c(NA, -6L))\nxy <- mydf[,c(1,2)]\nspdf <- SpatialPointsDataFrame(coords = xy, data = mydf, proj4string = CRS(\"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0\"))\n```\n:::\n\n\nFinally, plot the points we chose on the map of Australia.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(my_country)\nplot(spdf, add=T, col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nproj_temp_cities <- extract(proj_temp, spdf)\nproj_temp_cities <- as.data.frame(proj_temp_cities)\nproj_temp_cities <-as.data.frame(t(proj_temp_cities))\nproj_temp_cities$year <- 1:nrow(proj_temp_cities)+1980\nnames(proj_temp_cities) <- c(\"Brisbane\", \"Cairns\", \"Mackay\", \"Townsville\", \"Mount_Isa\", \"Longreach\", \"year\")\n```\n:::\n\n\nWe can plot the projected temperature change of the cities we have selected.\n\nWe can plot the projected temperature change of the cities we have selected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"reshape2\")\nlibrary(reshape2)\nproj_temp_cities_melt <- melt(proj_temp_cities, id=\"year\")\n\nts1 <- ggplot(proj_temp_cities_melt) +\n    geom_line(aes(x=year, y=value, colour=variable)) +\n    ggtitle(\"Projected average temperature ACCESS-ESM1.5 SSP3-7.0\") +\n    ylab(\"Temperature (°C)\")  +\n    scale_color_brewer(name= \"cities\", palette=\"Set1\") +\n    theme_bw() \nts1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n# 6 Convertig gridcells to data frame within a study area mask and plotting boxplots in ggplot2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(paste0(home, \"/IPCC\")) # Set work directory to CMIP6 data\ndir() \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CMIP6 - Consecutive Dry Days (CDD) Change days - Warming 1.5°C SSP5-8.5 (rel. to 1850-1900) - Annual (32 models).nc\"\n [2] \"CMIP6 - Consecutive Dry Days (CDD) Change days - Warming 2°C SSP5-8.5 (rel. to 1850-1900) - Annual (32 models).nc\"  \n [3] \"CMIP6 - Consecutive Dry Days (CDD) Change days - Warming 3°C SSP5-8.5 (rel. to 1850-1900) - Annual (32 models).nc\"  \n [4] \"CMIP6 - Consecutive Dry Days (CDD) Change days - Warming 4°C SSP5-8.5 (rel. to 1850-1900) - Annual (19 models).nc\"  \n [5] \"CMIP6 - Maximum temperature (TX) Change deg C - Warming 1.5°C SSP5-8.5 (rel. to 1850-1900) - Annual (27 models).nc\" \n [6] \"CMIP6 - Maximum temperature (TX) Change deg C - Warming 2°C SSP5-8.5 (rel. to 1850-1900) - Annual (27 models).nc\"   \n [7] \"CMIP6 - Maximum temperature (TX) Change deg C - Warming 3°C SSP5-8.5 (rel. to 1850-1900) - Annual (27 models).nc\"   \n [8] \"CMIP6 - Maximum temperature (TX) Change deg C - Warming 4°C SSP5-8.5 (rel. to 1850-1900) - Annual (16 models).nc\"   \n [9] \"CMIP6 - Mean temperature (T) Change deg C - Warming 1.5°C SSP5-8.5 (rel. to 1850-1900) - Annual (34 models).nc\"     \n[10] \"CMIP6 - Mean temperature (T) Change deg C - Warming 2°C SSP5-8.5 (rel. to 1850-1900) - Annual (34 models).nc\"       \n[11] \"CMIP6 - Mean temperature (T) Change deg C - Warming 3°C SSP5-8.5 (rel. to 1850-1900) - Annual (34 models).nc\"       \n[12] \"CMIP6 - Mean temperature (T) Change deg C - Warming 4°C SSP5-8.5 (rel. to 1850-1900) - Annual (20 models).nc\"       \n[13] \"CMIP6 - Total precipitation (PR) Change % - Warming 1.5°C SSP5-8.5 (rel. to 1850-1900) - Annual (33 models).nc\"     \n[14] \"CMIP6 - Total precipitation (PR) Change % - Warming 2°C SSP5-8.5 (rel. to 1850-1900) - Annual (33 models).nc\"       \n[15] \"CMIP6 - Total precipitation (PR) Change % - Warming 3°C SSP5-8.5 (rel. to 1850-1900) - Annual (33 models).nc\"       \n[16] \"CMIP6 - Total precipitation (PR) Change % - Warming 4°C SSP5-8.5 (rel. to 1850-1900) - Annual (19 models).nc\"       \n```\n:::\n\n```{.r .cell-code}\n# Mean temperature\ntemp_list <- list.files(path= paste0(home, \"/IPCC\"), pattern = \"Mean temperature\", full.names = TRUE)\ntemp_GW <- stack(temp_list)\nnames(temp_GW) <- c(\"GW1.5\", \"GW2.0\", \"GW3.0\", \"GW4.0\") \nplot(temp_GW)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#masking data outside country and converting grid to dataframe\n\ntemp_GW_country <- as.data.frame(mask(temp_GW, my_country))\ndim(temp_GW_country)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 64800     4\n```\n:::\n\n```{.r .cell-code}\nhead(temp_GW_country)\t\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  GW1.5 GW2.0 GW3.0 GW4.0\n1    NA    NA    NA    NA\n2    NA    NA    NA    NA\n3    NA    NA    NA    NA\n4    NA    NA    NA    NA\n5    NA    NA    NA    NA\n6    NA    NA    NA    NA\n```\n:::\n\n```{.r .cell-code}\ntemp_GW_country <- na.omit(temp_GW_country)\ndim(temp_GW_country)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 699   4\n```\n:::\n\n```{.r .cell-code}\n#install.packages(\"reshape2\")\nlibrary(reshape2)\ntemp_GW_country_m <- melt(temp_GW_country)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\n#creating a boxplot of avg temp per global warming level on ggplot2\n\nbp1 <- ggplot(temp_GW_country_m, aes(x=variable, y=value, fill=variable)) +\ngeom_boxplot()+\nxlab(\"Global warming level (°C)\")+\nylab(\"Change in average surface temperature (°C)\")+\nggtitle(paste(\"Change in average surface temperature per global warming level in \", my_country@data$NAME[1], sep=\"\")) +\ntheme_bw()\n\nbp1 <- bp1 + scale_color_brewer(name= \"GW level\", palette=\"YlOrRd\") # why it does not work? - change from color to fill\nbp1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n# 7 Repeat the extraction and plot for precipitation and/or other metrics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Total precipitation\nprec_list <- list.files(path= paste0(home, \"/IPCC\"), pattern = \"Total precipitation\", full.names = TRUE)\nprec_GW <- stack(prec_list)\nnames(prec_GW) <- c(\"GW1.5\", \"GW2.0\", \"GW3.0\", \"GW4.0\") \nplot(prec_GW)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#masking data outside country and converting grid to dataframe\n\nprec_GW_country <- as.data.frame(mask(prec_GW, my_country))\nprec_GW_GW_country <- na.omit(prec_GW_country)\nprec_GW_country_m <- melt(prec_GW_country)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNo id variables; using all as measure variables\n```\n:::\n\n```{.r .cell-code}\n#creating a boxplot of precipitation per global warming level on ggplot2\n\nbp2 <- ggplot(prec_GW_country_m, aes(x=variable, y=value, fill=variable)) +\ngeom_boxplot()+\nxlab(\"Global warming level (°C)\")+\nylab(\"Change in total precipitation (%)\")+\nggtitle(paste(\"Change in total precipitation per global warming level in \", my_country@data$NAME[1], sep=\"\")) +\ntheme_bw() +\nscale_fill_brewer(name= \"GW level\", palette=\"YlOrRd\")\nbp2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 256404 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n# Where to find climate data\n\n**IPCC interactive atlas** The authority for climate data is the IPCC. And the interactive atlas has the latest data https://interactive-atlas.ipcc.ch/regional-information\n\n**Worldclim** Global climate and weather data. WorldClim is a database of high spatial resolution global weather and climate data. https://www.worldclim.org/\n\n**SILO** gridded data for Australia until yesterday: https://longpaddock.qld.gov.au/silo/gridded-data/\n\n**LongPaddock** Provided by the Queensland Government, gridded data available for a range of variables in NetCDF and GeoTiff formats. The NetCDF datasets are arranged in annual blocks where each file contains all of the grids for the selected year and variable. https://longpaddock.qld.gov.au\n\n**CMIP5 downscaled climate projections over Queensland** High-resolution climate change projections for Queensland using dynamical downscaling of CMIP5 global climate models are available for download in gridded format with spatial resolution of 10 km at Terrestrial Ecosystem Research Network (TERN) https://longpaddock.qld.gov.au/qld-future-climate/data-info/tern/\n\n# About the author\n\n<img src=\"https://its-ss-academicportal.s3.amazonaws.com/prod/uqresearchers/photo/18673.jpeg\" width=\"180\" align=\"right\"/>\n\n<br> [![Twitter URL](https://img.shields.io/twitter/url/https/twitter.com/bukotsunikki.svg?style=social&label=Follow%20%2540RalphTrancoso)](https://twitter.com/RalphTrancoso)\n\nRalph is a research scientist with expertise in climate change, ecohydrology, and deforestation impacts. Ralph is particularly interested in how climate and landscape changes affect the environment and impact society. He is a Principal Climate Change Scientist at the Department of Environment and Science (Queensland Government) and a Research Fellow at the School of Biological Sciences (University of Queensland).\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}